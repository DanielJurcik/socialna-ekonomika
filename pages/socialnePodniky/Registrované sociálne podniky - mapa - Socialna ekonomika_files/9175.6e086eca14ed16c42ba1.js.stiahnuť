"use strict";(self.webpackChunkawesome_table_build=self.webpackChunkawesome_table_build||[]).push([[9175],{57370:function(e,t,r){r.d(t,{Bl:function(){return s},xY:function(){return f},Bx:function(){return l},MM:function(){return p}});var n,o,i,u=r(25400),a=r(42845);function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s={MICROSOFT:"MICROSOFT",GOOGLE:"GOOGLE"},f=(c(n={},s.MICROSOFT,s.MICROSOFT.toLowerCase()+".com"),c(n,s.GOOGLE,s.GOOGLE.toLowerCase()+".com"),n),l=(c(o={},s.MICROSOFT.toLowerCase()+".com",s.MICROSOFT),c(o,s.GOOGLE.toLowerCase()+".com",s.GOOGLE),c(i={},s.GOOGLE,{OAUTH_SCOPE_EDIT:a.Un,OAUTH_SCOPE_VIEW:a.Zz,OAUTH_CLIENT_ID:"56088344336-mes14nget7f5jb0pfmi0scngbb82l0qa.apps.googleusercontent.com",WEB_SERVICE_URL:"https://api.awesome-table.com",LOGIN_DISPLAY_PARAMS:{name:s.GOOGLE,icon:"awt:google-super-g",msgName:"googleLogin",msgId:"loginWithGoogle"}}),c(i,s.MICROSOFT,{OAUTH_SCOPE_EDIT:u.x1,OAUTH_SCOPE_VIEW:u.JS,OAUTH_SCOPE_COPY_VIEW:u.Zb,OAUTH_CLIENT_ID:u.lk,OAUTH_PROMPT_MODES:u.Sg,OAUTH_PROXY_SERVER:u.WV,OAUTH_REDIRECT_URL:u.i_,LOGIN_DISPLAY_PARAMS:{name:s.MICROSOFT,icon:"awt:ms-icon",msgName:"msLogin",msgId:"loginWithMicrosoft"}}),i),p=[l[s.GOOGLE].LOGIN_DISPLAY_PARAMS,l[s.MICROSOFT].LOGIN_DISPLAY_PARAMS]},42845:function(e,t,r){r.d(t,{Un:function(){return n},Zz:function(){return o},qx:function(){return i},Sx:function(){return u}});var n=["https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/drive.file","https://www.googleapis.com/auth/spreadsheets","https://spreadsheets.google.com/feeds"],o=["https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/userinfo.profile","https://spreadsheets.google.com/feeds"],i="offline_access",u="google"},57287:function(e,t,r){function n(e){return new Promise((function(t,r){e.then(t,r)}))}r.d(t,{Z:function(){return b}});var o=r(34207),i=r.n(o),u=r(57370),a=r(42845),c=r(25400);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var p=function(){var e,t=(l(e={},c.Bc,c.lk),l(e,a.Sx,"56088344336-mes14nget7f5jb0pfmi0scngbb82l0qa.apps.googleusercontent.com"),e),r=l({},c.Bc,{base:c.PN,get:{driveId:"me/drive",me:"me",sharedSheet:"users/@{userId}/drive/items/{@workbookId}/worksheets('@{sheetName}')/usedRange",sheet:"me/drive/items/@{workbookId}/workbook/worksheets('@{sheetName}')/usedRange?$select=values",sheetsList:"me/drive/root/search(q='.xlsx')?select=name,id,webUrl"},name:"".concat(c.Bc," ").concat(c.SJ),oauth:{auth:c.Dv.AUTH,grant:c.Dv.GRANT,response_type:"code",version:2},scope_delim:" ",xhr:function(e){var t=e.query.access_token;return delete e.query.access_token,t&&(e.headers=f(f({},e.headers),{},{Authorization:"Bearer ".concat(t)})),!0}}),n={response_type:"code",oauth_proxy:u.Bx.MICROSOFT.OAUTH_PROXY_SERVER,redirect_uri:u.Bx.MICROSOFT.OAUTH_REDIRECT_URL};i().init(t,n),i().init(r);var o=window.at_debug;return o&&(i().on("auth",(function(){o.log("HelloJS on auth")})),i().on("auth.init",(function(){o.log("HelloJS on auth.init")})),i().on("auth.login",(function(){o.log("HelloJS on auth.login")})),i().on("auth.logout",(function(){o.log("HelloJS on auth.logout")})),i().on("auth.update",(function(){o.log("HelloJS on auth.update")}))),i()}();function h(e,t,r,n,o,i,u){try{var a=e[i](u),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var b=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),v(this,"networkName",void 0),v(this,"_login",function(){var e,r=(e=regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n(p(t.networkName).login(r)));case 1:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function u(e){h(i,n,o,u,a,"next",e)}function a(e){h(i,n,o,u,a,"throw",e)}u(void 0)}))});return function(e){return r.apply(this,arguments)}}()),v(this,"_logout",(function(){return n(p(t.networkName).logout())})),v(this,"_onLogin",(function(e){return p.on("auth.login",e)})),v(this,"api",(function(e){if(!e)throw new Error("API name is missing");return n(p(t.networkName).api(e))})),v(this,"isTokenStillValid",(function(e){return Boolean(e&&e.access_token&&e.expires>(new Date).getTime()/1e3)}))}var t,r,o;return t=e,(r=[{key:"token",get:function(){var e;return null===(e=this.getSession())||void 0===e?void 0:e.access_token}},{key:"hasValidSession",value:function(){var e=this.getSession();return!!this.isTokenStillValid(e)&&e}},{key:"getSession",value:function(){return p(this.networkName).getAuthResponse()}}])&&d(t.prototype,r),o&&d(t,o),e}()},17764:function(e,t,r){r.d(t,{bo:function(){return u},hJ:function(){return a},l2:function(){return o},N1:function(){return s},dL:function(){return f},ZY:function(){return l},Q8:function(){return p},zE:function(){return h},LG:function(){return c},qo:function(){return d},iH:function(){return i}});var n=r(76691),o=(r(62509),r(37397),n.Z.initializeApp({apiKey:"AIzaSyAPCgK_J99eBCsm0Ub6vnivt3_GVFcXqVM",authDomain:"app.awesome-table.com",databaseURL:"https://".concat("awesome-table",".firebaseio.com/")},"at")),i=o.database().ref(),u=n.Z.database.ServerValue.TIMESTAMP,a=n.Z.auth.GoogleAuthProvider;function c(e){if(!e||0===e.length)throw new Error("scopes needed");for(var t=new n.Z.auth.GoogleAuthProvider,r=0;r<e.length;r++)t.addScope(e[r]);return t}var s=function(e){if(!e)throw new Error("firebase database driver need params");var t=e.app,r=e.ref;if(!t||!r)throw new Error("firebase database issue with params");return{read:function(e){return r.child(e).once("value")},set:function(e,t){return r.child(e).set(t)},insert:function(e,t){return r.child(e).push(t)},update:function(e,t){return r.child(e).update(t)},updateRoot:function(e){return r.update(e)},userIdToken:function(){var e,r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return null===(e=t.auth().currentUser)||void 0===e?void 0:e.getIdToken(r)}}}({app:o,ref:i}),f=s.read,l=s.set,p=(s.insert,s.update),h=s.updateRoot,d=s.userIdToken},82303:function(e,t,r){r.d(t,{zL:function(){return c},Iq:function(){return f},x4:function(){return l}});var n=r(47376),o=r.n(n),i=r(64363),u={};function a(e){return function(t){new Promise((function(t,r){window.gapi||r(s.GAPI_NOT_LOADED),window.gapi.load(e,t)})).then((function(){u[e]=Promise.resolve(window.gapi[e]),t(u[e])}))}}var c={get client(){return u.client||new Promise(a("client"))},get auth(){return u.auth||new Promise(a("auth"))},load:function(e){return new Promise((function(t,r){window.gapi||r(s.GAPI_NOT_LOADED),window.gapi.load(e,{callback:t})}))}},s={GAPI_NOT_LOADED:"gapi not loaded"},f=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=o().getParser(window.navigator.userAgent);if("safari"===r.getBrowserName(!0)){console.log("hello JS authorize flow");var n=new i.N;return n.login({login_hint:e.login_hint,scope:e.scope},e.immediate).then((function(e){var t=gapi.client.setToken;return null!=e&&e.access_token&&t({access_token:e.access_token}),e}))}return c.auth.then((function(r){return new Promise((function(n){return new Promise((function(o){window.at_debug&&t&&window.at_debug.log("Using timeout");var i=t?setTimeout((function(){console.log("resolving timeout"),n(void 0)}),1e4):null;r.authorize(e,(function(e){i&&clearTimeout(i),o(n(e))}))}))}))}))},l=function(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o={client_id:t,scope:Array.isArray(r)?r.join(" "):r};return o.immediate=!("immediate"in e)||e.immediate,"login_hint"in e?(o.authuser=-1,o.login_hint=e.login_hint):"authUser"in e&&(o.authuser=e.authUser,!1===o.immediate&&-1===o.authuser&&(delete o.immediate,o.prompt="select_account")),f(o,n).then((function(e){if(!e.access_token)throw e;return e}))}},64363:function(e,t,r){r.d(t,{N:function(){return y}});var n=r(47376),o=r.n(n),i=r(42845);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r,n,o,i,u){try{var a=e[i](u),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g(e);if(t){var o=g(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?m(e):t}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(b,e);var t,r,n,u,c,s=v(b);function b(){var e;p(this,b);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return w(m(e=s.call.apply(s,[this].concat(r))),"networkName",i.Sx),w(m(e),"onLogin",(function(t){e._onLogin(t)})),w(m(e),"logout",(function(){return e._logout()})),e}return t=b,(r=[{key:"login",value:(u=regeneratorRuntime.mark((function e(t,r){var n,u,c,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.hasValidSession())){e.next=3;break}return e.abrupt("return",n);case 3:if(u=void 0!==(null==t?void 0:t.authUser)?t.authUser:-1,c=u>-1||1==r?{display:"none",prompt:"none"}:{prompt:"consent"},void 0!==(null==t?void 0:t.immediate)&&delete t.immediate,!t||"number"!=typeof u){e.next=15;break}if(delete t.authUser,-1===u){e.next=12;break}t.authuser=u,e.next=15;break;case 12:if(!this.getSession()){e.next=15;break}return e.next=15,this.logout().catch((function(e){return console.log(e)}));case 15:return s=f(f(f({},c),{},{scope:[].concat(a(i.Zz),[i.qx]),response_type:"code"},t),{},{access_type:"offline"}),"safari"===o().getParser(window.navigator.userAgent).getBrowserName(!0)&&(s=f(f({},s),{},{display:"popup",prompt:"select_account"})),e.abrupt("return",this._login(s).then((function(e){if(!e.authResponse)throw"Issue while login with Hello JS";return e.authResponse})));case 19:case"end":return e.stop()}}),e,this)})),c=function(){var e=this,t=arguments;return new Promise((function(r,n){var o=u.apply(e,t);function i(e){l(o,r,n,i,a,"next",e)}function a(e){l(o,r,n,i,a,"throw",e)}i(void 0)}))},function(e,t){return c.apply(this,arguments)})}])&&h(t.prototype,r),n&&h(t,n),b}(r(57287).Z)},25400:function(e,t,r){r.d(t,{SJ:function(){return n},Bc:function(){return o},i_:function(){return i},lk:function(){return u},WV:function(){return a},Dv:function(){return c},PN:function(){return s},JS:function(){return h},x1:function(){return d},Zb:function(){return v},Sg:function(){return b}});var n="Awesome Table Graph API",o="microsoftAzure",i="/redirect",u="82434634-75ef-43e7-ac03-f8b2ae09b5e7",a="https://us-central1-awesometable-dev.cloudfunctions.net/oauthproxy",c={AUTH:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",GRANT:"https://login.microsoftonline.com/common/oauth2/v2.0/token"},s="https://graph.microsoft.com/v1.0/",f="user.read",l="offline_access",p="files.read.all",h=[f,l],d=[f,p,l],v=[f,p,"files.readwrite.all"],b={ADMIN_CONSENT:"admin_consent",CONSENT:"consent",LOGIN:"login",NONE:"none",SELECT_ACCOUNT:"select_account"}},5146:function(e,t,r){r.d(t,{Yy:function(){return y}});var n=r(57370),o=r(57287),i=r(25400),u=r(90621),a=r(47467);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r,n,o,i,u){try{var a=e[i](u),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function p(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function u(e){l(i,n,o,u,a,"next",e)}function a(e){l(i,n,o,u,a,"throw",e)}u(void 0)}))}}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g(e);if(t){var o=g(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?m(e):t}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(l,e);var t,r,o,c,s=v(l);function l(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),w(m(e=s.call(this)),"networkName",i.Bc),w(m(e),"_graph",void 0),w(m(e),"userInformation",p(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.graph.userInfos();case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",null);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))),w(m(e),"onLogin",(function(t){e._onLogin(t)})),e._graph=null,e}return t=l,(r=[{key:"getDriveId",value:function(){return this.api("driveId")}},{key:"graph",get:function(){return!this._graph&&this.token?(this._graph=new u.L({session:this.getSession()}),this._graph):this.hasValidSession()?(this._graph.bearerToken||this._graph.bearerToken===this.token||(delete this._graph,this._graph=new u.L({session:this.getSession()})),this._graph):null}},{key:"login",value:function(e,t){var r=f(f({},e?{display:"none",force:!0,prompt:"none"}:{}),{},{scope:n.Bx.MICROSOFT.OAUTH_SCOPE_EDIT},t);return this._login(r)}},{key:"logout",value:(c=p(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._logout();case 2:return r=e.sent,delete this._graph,this._graph=null,(0,a.t)(),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})}])&&h(t.prototype,r),o&&h(t,o),l}(o.Z);t.ZP=y;new y},90621:function(e,t,r){r.d(t,{L:function(){return l}});var n=r(25400);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t,r,n,o,i,u){try{var a=e[i](u),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){u(i,n,o,a,c,"next",e)}function c(e){u(i,n,o,a,c,"throw",e)}a(void 0)}))}}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),e}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=function(){function e(t){var r=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),f(this,"_bearerToken",void 0),f(this,"baseUrl",void 0),f(this,"userInfos",(function(){return r._call("me")})),f(this,"getMySites",(function(e){return r._call("sites?search=".concat(e||"*","&$select=name,webUrl,displayName"))})),f(this,"workBookWorkSheetsInfos",(function(e,t){return r._call("drives/".concat(e,"/items/").concat(t,"/workbook/worksheets"))})),f(this,"getExcelFileName",(function(e,t){return r._call("drives/".concat(e,"/items/").concat(t,"?$select=name"))})),f(this,"getMySharepointUrl",a(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r._call("me/?$select=mySite");case 3:if(200===(t=e.sent).status){e.next=6;break}throw new Error("Issue get my sharepoint "+t.status);case 6:return e.next=8,t.json();case 8:if((n=e.sent).hasOwnProperty("mySite")&&n.mySite){e.next=11;break}return e.abrupt("return",null);case 11:return e.abrupt("return",n.mySite+"Documents/Forms/All.aspx");case 14:throw e.prev=14,e.t0=e.catch(0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[0,14]])})))),f(this,"callGraphEndpoint",function(){var e=a(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t._graphEndpoint){e.next=6;break}return e.next=3,r._call(t._graphEndpoint);case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,null;case 8:e.t0=e.sent;case 9:return e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),f(this,"getWorkbook",function(){var t=a(regeneratorRuntime.mark((function t(n,o){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=e,t.next=4,r._call("drives/".concat(n,"/items/").concat(o));case 4:return t.t1=t.sent,t.abrupt("return",t.t0._buildNewWorkbookItem.call(t.t0,t.t1));case 8:throw t.prev=8,t.t2=t.catch(0),t.t2;case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,r){return t.apply(this,arguments)}}()),f(this,"userAndSharedWorkBooks",(function(){return Promise.all([r.userWorkbooks(),r.sharedWorkbooks()])})),f(this,"copyWorkbook",(function(e,t,n){return r._call("drives/".concat(t,"/items/").concat(e,"/copy"),"POST",!1,n)})),f(this,"uploadWorkbookFromBinaryValue",(function(e,t,n,o){return r._call("drives/".concat(e,"/items/").concat(t,":/").concat(encodeURIComponent(r._validateFileName(o)),":/content"),"PUT",!0,n,!1,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")})),f(this,"_validateFileName",(function(e){return e.replace(/[#*<>\/:?]/g,"")})),f(this,"retrieveWorkbookAfterCopy",(function(e,t){return r._call("drives/".concat(e,"/items/").concat(t))})),!t)throw new Error("params needed for graph helper");this.bearerToken=null,this.bearerToken=t.hasOwnProperty("session")&&t.session.hasOwnProperty("access_token")?t.session.access_token:null,this.baseUrl=n.PN}var t,r;return s(e,null,[{key:"extractDriveAndWorkbookId",value:function(e){var t={driveId:"",workbookId:""},r=e.hasOwnProperty("remoteItem")?e.remoteItem:e;return r.hasOwnProperty("id")&&r.hasOwnProperty("parentReference")&&r.parentReference.hasOwnProperty("driveId")&&(t.driveId=r.parentReference.driveId,t.workbookId=r.id),t}},{key:"_buildGraphEndpoint",value:function(t){var r=e.extractDriveAndWorkbookId(t);return""!==r.driveId&&"drives/".concat(r.driveId,"/items/").concat(r.workbookId)}}]),s(e,[{key:"photoBlob",value:function(){return this._call("me/photos('48x48')/$value","GET",!1)}},{key:"workbookSheetByWorkbookId",value:function(e,t){return this._call("me/drive/items/".concat(e,"/workbook/worksheets('").concat(t,"')/usedRange"))}},{key:"workBookSheetByDriveAndWorkbookId",value:function(e,t,r,n,o){return n?this._call("drives/".concat(e,"/items/").concat(t,"/workbook/worksheets('").concat(r,"')/range(address='").concat(n,"')")):this._call("drives/".concat(e,"/items/").concat(t,"/workbook/worksheets('").concat(r,"')/usedRange").concat(o?"?$select=".concat(o):""))}},{key:"workbookSheetByGraphEndpoint",value:function(e,t){return this._call("".concat(e,"/workbook/worksheets('").concat(t,"')/usedRange"))}},{key:"userWorkbooks",value:(r=a(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._call("me/drive/root/search(q='.xlsx')");case 2:if((r=t.sent).hasOwnProperty("value")&&r.value&&r.value.length&&r.value.constructor===Array){t.next=5;break}return t.abrupt("return",[]);case 5:return t.abrupt("return",r.value.map((function(t){return e._buildNewWorkbookItem(t)})));case 6:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"sharedWorkbooks",value:(t=a(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._call("me/drive/sharedWithMe");case 2:if((r=t.sent).hasOwnProperty("value")&&r.value&&r.value.length&&r.value.constructor===Array){t.next=5;break}return t.abrupt("return",[]);case 5:return t.abrupt("return",r.value.map((function(t){return e._buildNewWorkbookItem(t)})));case 6:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"_call",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3?arguments[3]:void 0,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5?arguments[5]:void 0;if(!this.bearerToken)throw new Error("Not authenticated");var u={method:t,headers:{"Content-type":i||"application/json",authorization:"Bearer ".concat(this.bearerToken)}};return n&&(u.body=o?JSON.stringify(n):n),fetch("".concat(this.baseUrl).concat(e),u).then((function(e){return r?e.json():e}))}},{key:"bearerToken",get:function(){return this._bearerToken},set:function(e){this._bearerToken=e}}]),e}();f(l,"_buildNewWorkbookItem",(function(e){return i(i({},e),{},{_graphEndpoint:l._buildGraphEndpoint(e),call:function(){return fetch(n.PN+l._buildGraphEndpoint(e))}})})),t.Z=l},47467:function(e,t,r){r.d(t,{v:function(){return d},t:function(){return v}});var n=r(25400),o=r(90621),i=r(91084);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t,r,n,o,i,u){try{var a=e[i](u),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}var f="".concat(window.location.origin,"/ms_picker"),l="Issue with One Drive SDK",p=function(e,t){return function(){var r,n=(r=regeneratorRuntime.mark((function r(n){var u,c,s;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.accessToken&&n.value.length){r.next=2;break}return r.abrupt("return",t(new Error(l)));case 2:return u=new o.Z({session:{access_token:n.accessToken}}),r.next=5,(0,i.Y3)(n.value[0],u);case 5:if(c=r.sent){r.next=8;break}return r.abrupt("return",t(new Error(l)));case 8:return r.next=10,c.getViewEditWorkSheetInfo();case 10:return(s=r.sent)||t(new Error("Error with file")),r.abrupt("return",e(a(a({},s),{},{accessToken:n.accessToken})));case 13:case"end":return r.stop()}}),r)})),function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function u(e){s(i,n,o,u,a,"next",e)}function a(e){s(i,n,o,u,a,"throw",e)}u(void 0)}))});return function(e){return n.apply(this,arguments)}}()},h=function(e){return function(t){t&&console.log(t),e&&e(t)}},d=function(e,t){var r,o,i={accountSwitchEnabled:!1,action:"query",clientId:n.lk,multiSelect:!1,advanced:{redirectUri:f}},u=p(e.success,e.error);t&&t.trueRender&&(r=e.success,o=e.error,u=function(e){return e.value.length?e.value[0].folder?r({accessToken:e.accessToken,folder:{folderId:e.value[0].id,driveId:e.value[0].parentReference.driveId}}):r({accessToken:e.accessToken,file:e.value[0]}):o(new Error(l))});var c=a(a(a({},i),e),{},{error:h(e.error),success:u});OneDrive.open(c)},v=function(){localStorage.removeItem("odpickerv7cache")}},91084:function(e,t,r){r.d(t,{$c:function(){return p},Y3:function(){return h},Yx:function(){return d},pw:function(){return v}});var n=r(74568);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(n=(u=a.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t,r,n,o,i,u){try{var a=e[i](u),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function f(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function u(e){s(i,n,o,u,a,"next",e)}function a(e){s(i,n,o,u,a,"throw",e)}u(void 0)}))}}var l=/\D+/,p=/\d+/,h=function(){var e=f(regeneratorRuntime.mark((function e(t,r){var n,o,c,s,p,h,d,v,b,m,g,w,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&r){e.next=2;break}return e.abrupt("return",null);case 2:return n=t.id,o=t.parentReference,e.next=5,r.getWorkbook(o.driveId,n);case 5:return c=e.sent,s=c.webUrl,h=function(e){var t=l.exec(e);return t?t[0]:""},d=function(e){var t=a(e.split(":"),2),r=t[0],n=t[1];return n?[r,h(n)].join(":"):""},v=function(e){return function(t){var r;return u(r={},"".concat(e,"Sheet"),t.name),u(r,"".concat(e,"Range"),d(t.address.split("!")[1])),r}},b=function(e){var t={},r=v("data");if(1===e.length)return r(e[0]);for(var n=0;n<e.length;n++){var o=e[n];if("data"===o.name.toLowerCase())return r(o);"template"!==o.name.toLowerCase()&&void 0===p&&(t=r(o),p=n)}return t},m=function(e){if(1===e.length)return null;for(var t=null,r=v("template"),n=0;n<e.length;n++){var o=e[n];if("template"===o.name.toLowerCase())return r(o);"data"!==o.name.toLowerCase()&&p!==n&&(t=r(o))}return t},g=function(e){return r.workBookSheetByDriveAndWorkbookId(o.driveId,n,e,void 0,"address")},w=function(){var e=f(regeneratorRuntime.mark((function e(){var t,u,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.workBookWorkSheetsInfos(o.driveId,n);case 2:return t=e.sent,u=t.value,e.next=6,Promise.all(u.map(function(){var e=f(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=i,e.t1={name:t.name},e.next=4,g(t.name);case 4:return e.t2=e.sent,e.next=7,(0,e.t0)(e.t1,e.t2);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:return a=e.sent,e.abrupt("return",{data:b(a),template:m(a)});case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=f(regeneratorRuntime.mark((function e(){var t,r,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:return t=e.sent,r=t.data,u=t.template,e.abrupt("return",i(i({webUrl:s,driveId:o.driveId,workbookId:n},r),u||{}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.abrupt("return",{getViewEditWorkSheetInfo:y,getUsedRangeForWorkSheet:g,createValues:v,id:n,parentReference:o});case 16:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),d=function(){var e=f(regeneratorRuntime.mark((function e(t,r,n,o,i){var u,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u={parentReference:{driveId:r.driveId,id:r.folderId},name:"".concat(n).concat(i?" ("+i+")":"",".xlsx")},e.next=3,o.copyWorkbook(t.id,t.driveId,u);case 3:if(409!==(a=e.sent).status){e.next=8;break}return i||(i=0),i++,e.abrupt("return",d(t,r,n,o,i));case 8:return e.abrupt("return",b(a,r,o));case 9:case"end":return e.stop()}}),e)})));return function(t,r,n,o,i){return e.apply(this,arguments)}}(),v=function(){var e=f(regeneratorRuntime.mark((function e(t,r,o,i){var u,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u="Awesome Table Template ".concat((new Date).toLocaleDateString().replace(/\//g,"-"),".xlsx"),3,a=0,c=function(){var e=f(regeneratorRuntime.mark((function e(){var s,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t).catch((function(e){throw new Error(e)}));case 2:return s=e.sent,e.t0=i,e.t1=r.driveId,e.t2=r.folderId,e.next=8,s.arrayBuffer();case 8:return e.t3=e.sent,e.t4=o,e.next=12,e.t0.uploadWorkbookFromBinaryValue.call(e.t0,e.t1,e.t2,e.t3,e.t4);case 12:if((f=e.sent).id&&f.webUrl){e.next=19;break}if(!(++a<=3)){e.next=18;break}return 3===a&&(o=u),e.abrupt("return",c());case 18:throw"Failed to copy workbook";case 19:return e.abrupt("return",{type:n.tW.EXCEL,spsResult:f});case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.next=6,c();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t,r,n,o){return e.apply(this,arguments)}}(),b=function(){var e=f(regeneratorRuntime.mark((function e(t,r,o){var i,u,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.headers.get("location"),e.next=3,fetch(i);case 3:return u=e.sent,e.next=6,u.json();case 6:return a=e.sent,e.next=9,o.retrieveWorkbookAfterCopy(r.driveId,a.resourceId);case 9:return c=e.sent,e.abrupt("return",{type:n.tW.EXCEL,spsResult:c});case 11:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()}}]);
//# sourceMappingURL=9175.6e086eca14ed16c42ba1.js.map